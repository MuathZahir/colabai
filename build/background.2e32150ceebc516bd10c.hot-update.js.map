{"version":3,"file":"background.2e32150ceebc516bd10c.hot-update.js","mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrQA","sources":["webpack://chrome-extension-boilerplate-react/./src/pages/Background/index.ts","webpack://chrome-extension-boilerplate-react/webpack/runtime/getFullHash"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n};\r\nconsole.log('This is the background page.');\r\nconsole.log('Put the background scripts here.');\r\nimport { NotebookChangeTracker } from './change-tracker';\r\nimport OpenAI from 'openai';\r\nimport ExtPay from 'extpay';\r\nlet notebookTracker;\r\nconst messages = [];\r\nlet openai;\r\nfetch('https://r378u5dqj3.execute-api.eu-north-1.amazonaws.com/default/colabGetData', {\r\n    method: 'post',\r\n})\r\n    .then(response => response.text())\r\n    .then(data => {\r\n    const key = JSON.parse(data).message;\r\n    openai = new OpenAI({ apiKey: key });\r\n});\r\nvar extpay = new ExtPay('colab');\r\nextpay.startBackground();\r\nconsole.log('Background Service Worker Loaded');\r\nchrome.runtime.onInstalled.addListener(() => __awaiter(void 0, void 0, void 0, function* () {\r\n    console.log('Extension installed');\r\n}));\r\nchrome.action.setBadgeText({ text: 'ON' });\r\nchrome.action.onClicked.addListener(() => {\r\n    chrome.tabs.query({ active: true, currentWindow: true }, tabs => {\r\n        const activeTab = tabs[0];\r\n        chrome.tabs.sendMessage(activeTab.id, { message: 'clicked_browser_action' });\r\n    });\r\n});\r\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\r\n    const { action } = message;\r\n    switch (action) {\r\n        case 'generateAI':\r\n            console.log(\"Generating...\");\r\n            generateAIContent(message.prompt, message.content, message.model)\r\n                .then(() => {\r\n                sendResponse({ success: true });\r\n            })\r\n                .catch(error => {\r\n                console.error(\"Error generating AI content: \", error);\r\n                sendResponse({ success: false, error: error.message });\r\n            });\r\n            return true; // Indicate that the response will be sent asynchronously\r\n        default:\r\n            sendResponse({ success: false, error: `Invalid action: ${action}` });\r\n            return false;\r\n    }\r\n});\r\nfunction trackNotebookChanges(currentCells) {\r\n    const tracker = notebookTracker || new NotebookChangeTracker();\r\n    notebookTracker = tracker;\r\n    console.log('Tracking notebook changes');\r\n    return tracker.updateState(currentCells);\r\n}\r\nfunction generateAIContent(prompt, content, model = \"gpt-3.5-turbo\") {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        console.log(\"Generating AI content...\");\r\n        console.log(\"Previous content:\", content);\r\n        const changeLog = trackNotebookChanges(content);\r\n        console.log(changeLog);\r\n        if (messages.length == 0)\r\n            messages.push({ role: \"system\", content: system_prompt });\r\n        messages.push({\r\n            role: \"user\",\r\n            content: `Changes since last message:\\n\\n${changeLog}\\n\\nUser request: ${prompt}`\r\n        });\r\n        console.log(messages);\r\n        try {\r\n            const stream = yield openai.chat.completions.create({\r\n                model: model,\r\n                messages: messages,\r\n                stream: true\r\n            });\r\n            chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => __awaiter(this, void 0, void 0, function* () {\r\n                var _a, e_1, _b, _c;\r\n                var _d, _e, _f;\r\n                const activeTab = tabs[0];\r\n                try {\r\n                    for (var _g = true, stream_1 = __asyncValues(stream), stream_1_1; stream_1_1 = yield stream_1.next(), _a = stream_1_1.done, !_a;) {\r\n                        _c = stream_1_1.value;\r\n                        _g = false;\r\n                        try {\r\n                            const chunk = _c;\r\n                            const content = ((_e = (_d = chunk.choices[0]) === null || _d === void 0 ? void 0 : _d.delta) === null || _e === void 0 ? void 0 : _e.content) || \"\";\r\n                            const done = ((_f = chunk.choices[0]) === null || _f === void 0 ? void 0 : _f.finish_reason) === 'stop';\r\n                            chrome.tabs.sendMessage(activeTab.id, { action: 'streamed_response', content, done }, response => {\r\n                            });\r\n                        }\r\n                        finally {\r\n                            _g = true;\r\n                        }\r\n                    }\r\n                }\r\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n                finally {\r\n                    try {\r\n                        if (!_g && !_a && (_b = stream_1.return)) yield _b.call(stream_1);\r\n                    }\r\n                    finally { if (e_1) throw e_1.error; }\r\n                }\r\n            }));\r\n        }\r\n        catch (error) {\r\n            console.error(\"Error generating AI content: \", error);\r\n        }\r\n    });\r\n}\r\nfunction generateAIContentTest() {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const response = \"Sure! I will create a simple Python Snake Game using the PGZ (Pygame Zero) library. Let's start by setting up the necessary structure in your notebook. @START_CODE @CREATE[type=markdown, position=top] # Simple Python Snake Game In this notebook, we will create a simple Snake Game using the Pygame library. Follow along as we build the game step by step. @END @CREATE[type=markdown, position=bottom] ## Game Setup First, we need to install Pygame, as it will be used to create the game window and handle game events. Make sure to install it before running the game. @END @CREATE[type=code, position=bottom] !pip install pgzero @END @CREATE[type=markdown, position=bottom] ## Importing Libraries Next, we will import the necessary libraries for our game. @END @EDIT[cell-vYQG-UVWi-V1] import pgzrun from random import choice, randint WIDTH = 800 HEIGHT = 600 snake = [(100, 100), (90, 100), (80, 100)] snake_dir = (10, 0) food = (400, 300) score = 0 @END @CREATE[type=markdown, position=bottom] ## Game Functions Now we will define the functions that will handle the game's logic. @END @CREATE[type=code, position=bottom] def draw(): screen.clear() screen.draw.text(f'Score: {score}', (10, 10), fontsize=40) for segment in snake: screen.draw.filled_rect(Rect(segment, (10, 10)), 'green') screen.draw.filled_rect(Rect(food, (10, 10)), 'red') def update(): global score head_x, head_y = snake[0] head_x += snake_dir[0] head_y += snake_dir[1] snake.insert(0, (head_x, head_y)) if (head_x, head_y) == food: score += 1 place_food() else: snake.pop() def place_food(): global food food = (randint(0, WIDTH // 10 - 1) * 10, randint(0, HEIGHT // 10 - 1) * 10) def on_key_down(key): global snake_dir if key == keys.UP and snake_dir != (0, 10): snake_dir = (0, -10) elif key == keys.DOWN and snake_dir != (0, -10): snake_dir = (0, 10) elif key == keys.LEFT and snake_dir != (10, 0): snake_dir = (-10, 0) elif key == keys.RIGHT and snake_dir != (-10, 0): snake_dir = (10, 0) @END @CREATE[type=markdown, position=bottom] ## Running the Game Finally, we will run the game. This will create the game window and all the necessary game loop logic. @END @CREATE[type=code, position=bottom] pgzrun.go() @END @END_CODE This structure sets up a simple Snake Game using the Pygame library. You can run each cell in sequence to see how the game develops. Let me know if you need additional features or modifications!\";\r\n        chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => __awaiter(this, void 0, void 0, function* () {\r\n            var _a, e_2, _b, _c;\r\n            const activeTab = tabs[0];\r\n            try {\r\n                for (var _d = true, _e = __asyncValues(response.split(' ')), _f; _f = yield _e.next(), _a = _f.done, !_a;) {\r\n                    _c = _f.value;\r\n                    _d = false;\r\n                    try {\r\n                        const chunk = _c;\r\n                        console.log(chunk || \"\");\r\n                        chrome.tabs.sendMessage(activeTab.id, { action: 'streamed_response', content: chunk || \"\" }, response => {\r\n                            console.log(response);\r\n                        });\r\n                    }\r\n                    finally {\r\n                        _d = true;\r\n                    }\r\n                }\r\n            }\r\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n            finally {\r\n                try {\r\n                    if (!_d && !_a && (_b = _e.return)) yield _b.call(_e);\r\n                }\r\n                finally { if (e_2) throw e_2.error; }\r\n            }\r\n        }));\r\n    });\r\n}\r\nconst system_prompt = `Google Colab Notebook Cell Manipulation Guidelines\n\nYou can perform the following operations on notebook cells. Use these command markers to specify operations:\n\nCell Operations:\n1. Create new cell:\n@CREATE[type=markdown|code, position=top|bottom|after:cell-{cellId}|before:cell-{cellId}]\ncontent\n@END\n\n2. Delete cell:\n@DELETE[cell-{cellId}]\n\n3. Edit existing cell:\n@EDIT[cell-{cellId}]\nnew content\n@END\n\nThese are the ONLY operations you can perform on notebook cells. Make sure to follow the correct syntax and structure for each operation.\n\nRequired Structure:\n- Start with H1 title for main topic\n- Use H2/H3 headers for sections/subsections\n- Begin with imports/setup\n- End with summary/conclusion\n\nMarkdown Cells:\n- Use formatting: bold, italic, lists, tables\n- Add context before code cells\n- Include LaTeX for math equations\n- Embed diagrams/charts where needed\n\nCode Cells:\n- Break into logical chunks\n- Add helpful comments\n- Use descriptive names\n- Group related code together\n\nNotebook Changes (Between @CHANGELOG and @END_CHANGELOG):\n- You will receive a list of changes that happened to the notebook cells since the last message\n- This will include changes you made as well as changes made by the user\n- These are not commands, but a summary of changes that happened before. Don't include these in your response\n- These changes are cumulative and will be sent in sequence\n\nStart and End Markers:\n- To start writing the operations use @START_CODE\n- To end writing the operations use @END_CODE\n- You can write in normal text before and after these markers, explaining what you are doing or replying to the user\n- Be very brief and clear in your responses before and after the markers. Also don't attempt to write in markdown format\n\nSample Examples:\n\n1. Create new markdown cell after cell 123:\n@CREATE[type=markdown, position=after:cell-123]\n## Data Processing\nIn this section, we'll clean our dataset\n@END\n\n2. Create new code cell at bottom:\n@CREATE[type=code, position=bottom]\ndef process_data(df):\n    return df.dropna()\n@END\n\n3. Edit existing cell:\n@EDIT[cell-456]\nimport pandas as pd\nimport numpy as np\n@END\n\n4. Delete cell:\n@DELETE[cell-789]\n\nFull Example:\nSure thing! Here's a sample structure for a data analysis project:\n@START_CODE\n@CREATE[type=markdown, position=top]\n# Data Analysis Project\n@END\n\n@CREATE[type=code, position=bottom]\nimport pandas as pd\n@END\n\n@EDIT[cell-123]\ndf = pd.read_csv('data.csv')\n@END\n...\n@END_CODE\nThis will help you get started with your project. Let me know if you need any more help!\n\nRemember:\n- Each operation must use the correct syntax\n- Cell IDs must be specified for position-dependent operations\n- Operations are executed in sequence\n- Content between @CREATE/@EDIT and @END maintains original formatting\n- For code cells, ensure proper indentation is preserved\n- Be smart with the layout. If part of the content is already present, don't repeat it. Remove unnecessary or redundant content.\n\nOutput Format:\nThe assistant should provide cell operations using the above syntax. Multiple operations can be specified in sequence. The final output should be a well-structured notebook with the requested changes.`;\r\nchrome.commands.onCommand.addListener(command => {\r\n    console.log(`Command: ${command}`);\r\n    if (command === 'refresh_extension') {\r\n        chrome.runtime.reload();\r\n    }\r\n});\r\n","__webpack_require__.h = () => (\"46c49f4532132f0e5f22\")"],"names":[],"sourceRoot":""}